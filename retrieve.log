2024-11-08 16:53:48:DEBUG:jieba:Building prefix dict from /home/s1136102/python/AICUP/custom_dicts/dict.txt.big ...
2024-11-08 16:53:48:DEBUG:jieba:Loading model from cache /tmp/jieba.ua6683cd5b6b7d5b3ab16049ce5b543c6.cache
2024-11-08 16:53:49:DEBUG:jieba:Loading model cost 1.169 seconds.
2024-11-08 16:53:49:DEBUG:jieba:Prefix dict has been built successfully.
2024-11-08 16:53:49:INFO:__main__:載入自定義字典: ./custom_dicts/with_frequency/common_use_dict_with_frequency.txt
2024-11-08 16:53:49:INFO:__main__:載入自定義字典: ./custom_dicts/with_frequency/insurance_dict_with_frequency.txt
2024-11-08 16:53:49:INFO:utils.rag_processor.resource_loader:Loading stopwords success
2024-11-08 16:53:49:INFO:utils.rag_processor.resource_loader:stopwords: {'前', '或', '年', '外', '對', '本', '【', '.', '然而', '人', '他們', '從前', '但', '又', '由', '_', '你', '他', '得', '|', '應該', '因此', '2', '：', '因', '！', '頁', '~', '﹑', '為', '中', '係', '與', '關', '至', '啊', '怎麼', '\\', ';', '及', '吧', '%', '附', '＿', '一直', '•', '裡', '有限公司', '～', '並', '所以', '之', '的', '它', '有', '﹒', '？', '同時', '下', '。', '著', '第', '和', '時', ')', '–', '1', '依', '「', '我們', '於', '呢', ']', '{', '而', '$', '如果', '4', '雖然', '!', '以前', '(', '不', '什麼', '等', '新', '-', '項', '；', '但是', '最近', '了', ',', "'", '喔', '比如說', '呀', '且', '使', '左', '我', '嗎', '"', '上', '請', '哇', '）', '是', '被', '％', '〃', '／', '經常', '未', '應', ':', '．', '內', '需要', '如何', '已', '期', '」', '因而', '[', '公司', '`', '註', '將', '該', '可', '併', '若', '/', '即使', '需', '比如', '以及', '其', '以', '開始', '}', '在', '二季', '3', '約', '並且', '如', '、', '邊', '後來', '客戶', '也', '產品', '，', '現在', '︰', '她', '＄', '因為', '?', '保險', '#', '剛才', '&', '則', '你們', '右', '後', '（', '三季', '一季', '－', '哦', '】'}
2024-11-08 16:53:49:INFO:gensim.utils:loading KeyedVectors object from /home/s1136102/python/AICUP/utils/../word2vec/wiki.zh.bin
2024-11-08 16:53:49:INFO:gensim.utils:loading vectors from /home/s1136102/python/AICUP/utils/../word2vec/wiki.zh.bin.vectors.npy with mmap=None
2024-11-08 16:53:49:INFO:gensim.utils:KeyedVectors lifecycle event {'fname': '/home/s1136102/python/AICUP/utils/../word2vec/wiki.zh.bin', 'datetime': '2024-11-08T16:53:49.729807', 'gensim': '4.3.3', 'python': '3.9.12 (main, Jun  1 2022, 11:38:51) \n[GCC 7.5.0]', 'platform': 'Linux-5.4.0-150-generic-x86_64-with-glibc2.27', 'event': 'loaded'}
2024-11-08 16:53:49:INFO:utils.rag_processor.resource_loader:Word2Vec model loaded successfully
2024-11-08 16:53:52:INFO:datasets:PyTorch version 2.4.0+cu121 available.
2024-11-08 16:53:52:INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-m3
2024-11-08 16:53:58:INFO:__main__:Config:
{
  "stopwords_filepath": "./custom_dicts/stopwords.txt",
  "embedding_model_name": "BAAI/bge-m3",
  "bm25_k1": 0.5,
  "bm25_b": 0.7,
  "bm25_epsilon": 0.5,
  "use_expansion": false,
  "expansion_model_path": "../word2vec/wiki.zh.bin",
  "expanded_topn": 2,
  "chunk_size": 500,
  "overlap": 100,
  "use_faiss": true,
  "use_term_importance": true,
  "use_semantic_search": true,
  "use_term_density": true,
  "use_query_coverage": true,
  "use_position_score": true,
  "use_context_similarity": true
}
2024-11-08 16:53:58:INFO:__main__:================================================================= QID: 1 =================================================================
2024-11-08 16:53:58:INFO:utils.rag_processor.query_processor:query分詞結果: 銀/負擔/所/誰/收取/費用/中間行/匯款/中間/行/相關
2024-11-08 16:53:58:INFO:utils.rag_processor.query_processor:query擴展詞: 
2024-11-08 16:53:58:INFO:utils.rag_processor.document_processor:BM25 Rank 1: PDF 392, Chunk 3, Score: 21.3709, Term Importance: 8.2921, Semantic Similarity: 0.9965, Query Coverage: 1.8076, Position Score: 0.0158, Term Density: 1.7248, Context Similarity: 26.0313, Frequency: [('匯款', 12), ('相關', 11), ('費用', 8), ('行', 8), ('銀', 7), ('負擔', 5), ('所', 2), ('收取', 2), ('中間', 1)]
2024-11-08 16:53:58:INFO:utils.rag_processor.document_processor:BM25 Rank 2: PDF 392, Chunk 4, Score: 11.6366, Term Importance: 9.8385, Semantic Similarity: 0.9938, Query Coverage: 1.0430, Position Score: 0.0422, Term Density: 1.1573, Context Similarity: 11.3078, Frequency: [('行', 7), ('銀', 6), ('相關', 4), ('匯款', 2), ('費用', 1), ('負擔', 1)]
2024-11-08 16:53:58:INFO:utils.rag_processor.document_processor:BM25 Rank 3: PDF 440, Chunk 1, Score: 4.4794, Term Importance: 0.2200, Semantic Similarity: 0.9908, Query Coverage: 0.4248, Position Score: 0.0144, Term Density: 0.2336, Context Similarity: 9.0412, Frequency: [('相關', 2), ('費用', 2), ('負擔', 2)]
2024-11-08 16:53:58:INFO:utils.rag_processor.document_processor:BM25 Rank 4: PDF 196, Chunk 1, Score: 4.4328, Term Importance: 0.1196, Semantic Similarity: 0.9914, Query Coverage: 0.5333, Position Score: 0.0220, Term Density: 0.2336, Context Similarity: 3.6214, Frequency: [('行', 1), ('相關', 1), ('費用', 1), ('負擔', 1)]
2024-11-08 16:53:58:INFO:utils.rag_processor.document_processor:BM25 Rank 5: PDF 442, Chunk 2, Score: 3.7605, Term Importance: 0.0426, Semantic Similarity: 0.9921, Query Coverage: 0.4248, Position Score: 0.2793, Term Density: 0.2336, Context Similarity: 4.5355, Frequency: [('相關', 1), ('費用', 1), ('負擔', 1)]
2024-11-08 16:54:00:INFO:faiss.loader:Loading faiss with AVX2 support.
2024-11-08 16:54:00:INFO:faiss.loader:Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2024-11-08 16:54:00:INFO:faiss.loader:Loading faiss.
2024-11-08 16:54:00:INFO:faiss.loader:Successfully loaded faiss.
2024-11-08 16:54:00:INFO:utils.RAGProcessor:----------------------------------------------------------------------------------------------------
2024-11-08 16:54:00:INFO:utils.RAGProcessor:FAISS Score: [0.8990], PDF: 392, Chunk: 3, metadata: [{}]
2024-11-08 16:54:00:INFO:utils.RAGProcessor:FAISS Score: [0.9925], PDF: 392, Chunk: 4, metadata: [{}]
2024-11-08 16:54:00:INFO:utils.RAGProcessor:FAISS Score: [1.0101], PDF: 440, Chunk: 2, metadata: [{}]
2024-11-08 16:54:00:INFO:utils.RAGProcessor:FAISS Score: [1.0655], PDF: 431, Chunk: 1, metadata: [{}]
2024-11-08 16:54:00:INFO:utils.RAGProcessor:FAISS Score: [1.0676], PDF: 51, Chunk: 2, metadata: [{}]
2024-11-08 16:54:00:INFO:utils.RAGProcessor:Adjusted Weights: {'bm25': 0.23076923076923075, 'faiss': 0.28846153846153844, 'importance': 0.0, 'semantic': 0.07692307692307694, 'coverage': 0.11538461538461538, 'position': 0.09615384615384616, 'density': 0.14423076923076922, 'context': 0.04807692307692308}
2024-11-08 16:54:00:INFO:utils.RAGProcessor:PDF 392, Chunk 3: Final Score=0.9044, BM25=1.0000, FAISS=1.0000, Importance=0.8421, Semantic=1.0000, Coverage=1.0000, Position=0.0055, Density=1.0000, Context=1.0000
2024-11-08 16:54:00:INFO:utils.RAGProcessor:PDF 392, Chunk 4: Final Score=0.4396, BM25=0.4472, FAISS=0.4457, Importance=1.0000, Semantic=0.5247, Coverage=0.4471, Position=0.1049, Density=0.6194, Context=0.3430
2024-11-08 16:54:00:INFO:utils.RAGProcessor:PDF 442, Chunk 2: Final Score=0.1168, BM25=0.0000, FAISS=0.0000, Importance=0.0000, Semantic=0.2425, Coverage=0.0000, Position=1.0000, Density=0.0000, Context=0.0408
2024-11-08 16:54:00:INFO:utils.RAGProcessor:PDF 440, Chunk 2: Final Score=0.0984, BM25=0.0000, FAISS=0.3412, Importance=0.0000, Semantic=0.0000, Coverage=0.0000, Position=0.0000, Density=0.0000, Context=0.0000
2024-11-08 16:54:00:INFO:utils.RAGProcessor:PDF 196, Chunk 1: Final Score=0.0289, BM25=0.0382, FAISS=0.0000, Importance=0.0079, Semantic=0.1075, Coverage=0.0785, Position=0.0288, Density=0.0000, Context=0.0000
2024-11-08 16:54:00:INFO:utils.RAGProcessor:PDF 440, Chunk 1: Final Score=0.0210, BM25=0.0408, FAISS=0.0000, Importance=0.0181, Semantic=0.0000, Coverage=0.0000, Position=0.0000, Density=0.0000, Context=0.2418
2024-11-08 16:54:00:INFO:utils.RAGProcessor:PDF 431, Chunk 1: Final Score=0.0036, BM25=0.0000, FAISS=0.0124, Importance=0.0000, Semantic=0.0000, Coverage=0.0000, Position=0.0000, Density=0.0000, Context=0.0000
2024-11-08 16:54:00:INFO:utils.RAGProcessor:PDF 51, Chunk 2: Final Score=0.0000, BM25=0.0000, FAISS=0.0000, Importance=0.0000, Semantic=0.0000, Coverage=0.0000, Position=0.0000, Density=0.0000, Context=0.0000
2024-11-08 16:54:00:INFO:utils.RAGProcessor:----------------------------------------------------------------------------------------------------
2024-11-08 16:54:00:INFO:utils.RAGProcessor:Final Rankings (Adaptive Weights):
2024-11-08 16:54:00:INFO:utils.RAGProcessor:Query Features - Length: 11, Diversity: 0.92
2024-11-08 16:54:00:INFO:__main__:================================================================= QID: 2 =================================================================
2024-11-08 16:54:00:INFO:utils.rag_processor.query_processor:query分詞結果: 本公司/書面/通知/多少/效力/要保人/書面通知/保人/多少天/停止日/停止
2024-11-08 16:54:00:INFO:utils.rag_processor.query_processor:query擴展詞: 
2024-11-08 16:54:00:INFO:utils.rag_processor.document_processor:BM25 Rank 1: PDF 428, Chunk 1, Score: 12.5361, Term Importance: 3.6070, Semantic Similarity: 0.9827, Query Coverage: 0.7377, Position Score: 0.0156, Term Density: 0.6033, Context Similarity: 7.8977, Frequency: [('本公司', 8), ('保人', 6), ('要保人', 6), ('通知', 4), ('書面', 3), ('書面通知', 3), ('效力', 2), ('停止', 2), ('停止日', 1)]
2024-11-08 16:54:00:INFO:utils.rag_processor.document_processor:BM25 Rank 2: PDF 428, Chunk 0, Score: 12.1967, Term Importance: 0.1956, Semantic Similarity: 0.9793, Query Coverage: 0.7377, Position Score: 0.0145, Term Density: 0.6033, Context Similarity: 9.3751, Frequency: [('本公司', 11), ('保人', 6), ('要保人', 6), ('效力', 3), ('停止', 3), ('書面', 2), ('通知', 2), ('書面通知', 2), ('停止日', 1)]
2024-11-08 16:54:00:INFO:utils.rag_processor.document_processor:BM25 Rank 3: PDF 565, Chunk 3, Score: 6.9291, Term Importance: 0.7545, Semantic Similarity: 0.9826, Query Coverage: 0.2336, Position Score: 0.0164, Term Density: 0.1252, Context Similarity: 9.1443, Frequency: [('本公司', 7), ('保人', 6), ('要保人', 6), ('效力', 4), ('通知', 3), ('停止', 1), ('書面', 1)]
2024-11-08 16:54:00:INFO:utils.rag_processor.document_processor:BM25 Rank 4: PDF 565, Chunk 1, Score: 6.9253, Term Importance: 1.7085, Semantic Similarity: 0.9816, Query Coverage: 0.2336, Position Score: 0.0137, Term Density: 0.1254, Context Similarity: 9.3546, Frequency: [('保人', 10), ('要保人', 10), ('效力', 6), ('本公司', 5), ('停止', 5), ('通知', 2), ('書面', 1)]
2024-11-08 16:54:00:INFO:utils.rag_processor.document_processor:BM25 Rank 5: PDF 606, Chunk 0, Score: 6.9086, Term Importance: 0.3824, Semantic Similarity: 0.9817, Query Coverage: 0.2336, Position Score: 0.0171, Term Density: 0.1252, Context Similarity: 9.1385, Frequency: [('保人', 7), ('要保人', 7), ('效力', 6), ('本公司', 4), ('通知', 3), ('停止', 2), ('書面', 1)]
